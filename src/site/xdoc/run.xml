<?xml version="1.0" encoding="UTF-8"?>
<!--
  Copyright 2009-2013 Hippo B.V. (http://www.onehippo.com)

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with
  the License. You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0 Unless required by
  applicable law or agreed to in writing, software distributed under
  the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES
  OR CONDITIONS OF ANY KIND, either express or implied. See the
  License for the specific language governing permissions and
  limitations under the License.
-->
<!DOCTYPE document PUBLIC "-//Apache Software Foundation//DTD XDOC 1.0//EN" "http://maven.apache.org/dtd/xdoc_1_0.dtd">
<document>
  <properties>
    <title>Running the JCR Runner</title>
  </properties>
  <body>
    <section name="Running">
      <subsection name="Using the zip">
        <subsection name="Install">
          <p>Download the latest release from the files section</p>
          <p>Unzip</p>
        </subsection>
        <subsection name="Run">
          <p>On windows use</p>
          <code>bin/jcr-runner.bat</code>
          <p>On linux/osx use</p>
          <code>sh bin/jcr-runner</code>
        </subsection>
      </subsection>
      <subsection name="From source">
        <subsection name="Install">
          <p>Check out the source from svn:</p>
          <code>svn co http://forge.onehippo.org/svn/jcr-runner/trunk jcr-runner</code>
        </subsection>
        <subsection name="Build and run">
          <p>In the project root type</p>
          <code>mvn clean compile exec:java</code>
          <p>After the first run you can use the slightly faster command</p>
          <code>mvn -o -q compile exec:java</code>
        </subsection>
      </subsection>
      <subsection name="Configuring the properties">
        <p>The properties can be found in the runner.properties</p>
        <subsection name="Configuring the path to traverse">
          <p>In the (absolute) path
            <strong>*</strong>
            and
            <strong>**</strong>
            can be used. For example:
          </p>
          <code>repository.path=/content/documents/*/2009/**</code>
          <p>This will match /content/documents/[any path element]/2009/[everything below]</p>
        </subsection>
        <subsection name="Using queries">
          <code>repository.query.language=xpath</code>
          <p>Specify the query language, in this case "xpath"</p>
          <code>repository.query=content/gallery//element(*, hippogallery:imageset)</code>
          <p>This will match all document; within path "content/gallery which are of the type "hippogallery:imageset"
          </p>
        </subsection>
        <subsection name="Configuring the plugin">
        </subsection>
        <subsection name="Example path usage">
          <pre>
            <code>
              # repository configuration
              repository.url=rmi://127.0.0.1:1099/hipporepository
              repository.user=admin
              repository.pass=admin

              # everything that starts with /content/documents
              repository.path=/content/documents/**

              # Java plugins
              plugins.java.logplugin.class=org.onehippo.forge.jcrrunner.plugins.LoggingPlugin
            </code>
          </pre>
        </subsection>
        <subsection name="Example query usage">
          <pre>
            <code>
              # repository configuration
              repository.url=rmi://127.0.0.1:1099/hipporepository
              repository.user=admin
              repository.pass=admin

              repository.query.language=xpath
              repository.query=content/gallery//element(*, hippogallery:imageset)

              # Java plugins
              plugins.java.logplugin.class=org.onehippo.forge.jcrrunner.plugins.LoggingPlugin
            </code>
          </pre>
          <p>Note that you will have to change the pom.xml to run Jcr<b>Query</b>Runner</p>
        </subsection>
      </subsection>
    </section>
  </body>
</document>
